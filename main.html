<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AWS Pricing Calculator</title>
    <link rel="stylesheet" href="styles.css">
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.1040.0.min.js"></script>
</head>
<body>
    <img src="BellBlazeTech-Logo.png" alt="Logo" class="logo">
    <header>
        <h1>AWS Pricing CalculatorðŸ’°</h1>
    </header>
    <div class="container">
        <!-- File Upload & Download Section -->
        <div class="column file-section">
            <h2 class="m1">ðŸ“‚ Upload & Download Files</h2>
            <div class="upload-section">
                <div class="col">
                <input type="file" id="fileInput" accept=".xls,.xlsx,.xlsm,csv">
                <p>Please upload <strong>Excel</strong> files only (Max size: <strong>1 MB</strong>)</p>
                </div>
                <button onclick="uploadFile()">
                    <img src="upload.png" class="button-icon">Upload
                </button>
            </div>
            <div id="uploadStatus" class="status-message"> </div>

            <div class="file-list-section">
                <h2>ðŸ“œ Available Files</h2>
                <select id="fileDropdown"></select>
                <button onclick="downloadSelectedFile()"><img src="download.png" class="button-icon">Download</button>
            </div>
        </div>

        <!-- Chatbot Section -->
        <div class="column chat-container">
            <h2>ðŸ¤– AI Chatbot</h2>
            <div class="chatbox" id="chatbox">
                <div id="messages"></div>
            </div>
            <div class="chat-input">
                <input type="text" id="userInput" placeholder="Describe your server configuration..." />
                <button onclick="sendMessage()"><img src="send.png" class="icon">Send</button>
            </div>
        </div>
    </div>

    <!-- Dynamic Subscription Status Display -->
    <div id="subscriptionStatus" class="usage-counter">
        <!-- Content will be filled by JavaScript -->
    </div>

    <div id="subscribeButtonContainer">
        <!-- Subscribe button will be shown/hidden by JavaScript -->
        <button onclick="subscribe()" class="subscribe">
            Subscribe
        </button>
    </div>

    <button onclick="logout()" class="logout">
        Sign Out
    </button>

    <script src="script.js"></script>
    <script src="chat.js"></script>
    
    <script>
        // Check subscription status on page load
        document.addEventListener('DOMContentLoaded', function() {
            checkSubscriptionStatus();
        });

        function checkSubscriptionStatus() {
            const isSubscribed = localStorage.getItem("subscribed") === "true";
            const subscriptionStatusDiv = document.getElementById('subscriptionStatus');
            const subscribeButtonContainer = document.getElementById('subscribeButtonContainer');
            
            if (isSubscribed) {
                // User is subscribed - show premium status
                subscriptionStatusDiv.innerHTML = `
                    <div class="premium-badge">
                        <strong>Premium User:</strong> Unlimited Access
                    </div>
                `;
                // Hide subscribe button
                subscribeButtonContainer.style.display = 'none';
            } else {
                // User is not subscribed - show free tier limits
                subscriptionStatusDiv.innerHTML = `
                    <strong>Free Tier Limits:</strong>
                    File Uploads: <span id="uploadCountDisplay">0</span>/3,
                    Queries used: <span id="queryCountDisplay">0</span>/6 
                `;
                // Show subscribe button
                subscribeButtonContainer.style.display = 'block';
                // Update counters
                updateUsageCounters();
            }
        }

        function subscribe() {
            localStorage.setItem("subscribed", "true");
            alert("âœ… Thank you for subscribing! All limits have been reset.");
            checkSubscriptionStatus();
        }

        function logout() {
            // Clear all stored data
            localStorage.removeItem("uploadCount");
            localStorage.removeItem("queryCount");
            localStorage.removeItem("subscribed");
            localStorage.removeItem("scrollPosition");
            localStorage.removeItem("storedFiles");
            
            // Redirect to the desired page
            window.location.href = "https://www.bellblazetech.com/products/our-solutions";
        }

        function updateUsageCounters() {
            document.getElementById("uploadCountDisplay").textContent = localStorage.getItem("uploadCount") || "0";
            document.getElementById("queryCountDisplay").textContent = localStorage.getItem("queryCount") || "0";
        }
    </script>        
</body>
</html>